<!DOCTYPE html>
<html lang="en">
  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="Piotr Kosmowski">
	<link rel="shortcut icon" href="favicon.ico">

	<title>Piotr Kosmowski page</title>

	<!-- Fonts -->
	<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">

	<!-- Bootstrap core CSS -->
	<link href="/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/font-awesome.min.css" rel="stylesheet">
	<link href="/css/bootstrap-social.css" rel="stylesheet">

	<!-- Styles -->
	<link href="/css/main.css" rel="stylesheet">

	<!-- Loading bar -->
	<script src="/js/jquery-1.10.2.min.js"></script>
	<script src="/js/jquery.stoc.js"></script>
	

	
	<!-- HTML5 shiv for IE8 support -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>
	

	<section id="sidebar" class="col-sm-3 sidebar" style="display: inline-block;">
<header id="header">
	<a href="/">
	<img src="http://www.gravatar.com/avatar/a4e3f3d974bfdd573f2bb607617b82c1.png" alt="Piotr Kosmowski" id="gravatar"/>
	<p id="author-full-name">Piotr Kosmowski</p>
	<p id="slogan">Hi, I'm Piotr and I write code for food.</p>
</a>
</header>
<nav id="navigation">
	<div class="row">
		<a href="http://twitter.com/kospiotr" class="btn btn-default">Twitter</a>
		<a href="http://pl.linkedin.com/pub/piotr-kosmowski/25/379/467" class="btn btn-default">LinkedIn</a>
		<a href="/blog" class="btn btn-default">Blog</a>
	</div>
	<div class="row">	
		<a href="http://github.com/kospiotr" class="btn btn-default">Github</a>
		<a href="/wiki" class="btn btn-default">Wiki</a>
	</div>
</nav>
	</section>

	<section id="main" class="col-sm-9">
		<div id="main-container">
<article id="main-article">
	<header id="header">
		<nav id="nav"><a href="/wiki" class="btn btn-default">Wiki index</a></nav>
		<h1 id="page-title">Jetty</h1>

		
	</header>
	<div id="article-body" class="markdown-body">


	<div id="TOC"></div>


<h1>Versions</h1>

<p>This document is about Jetty 8 version </p>

<ul>
<li>Jetty 6 <a href="http://docs.codehaus.org/display/JETTY/Jetty%20Documentation">http://docs.codehaus.org/display/JETTY/Jetty%20Documentation</a></li>
<li>Jetty 7 <a href="http://wiki.eclipse.org/Jetty">http://wiki.eclipse.org/Jetty</a></li>
<li>Jetty 8 <a href="http://wiki.eclipse.org/Jetty">http://wiki.eclipse.org/Jetty</a></li>
<li>Jetty 9 <a href="http://www.eclipse.org/jetty/documentation/current/">http://www.eclipse.org/jetty/documentation/current/</a></li>
</ul>

<h1>Run Jetty</h1>

<h2>Standalone</h2>

<p>Create script in jetty folder called start.bat with content:</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">c:<span class="se">\o</span>pt<span class="se">\j</span>dk<span class="se">\b</span>in<span class="se">\j</span>ava -jar start.jar
</code></pre></div>
<h2>Embedded with Maven plugin</h2>

<h3>Plugin</h3>

<p>Put in pom.xml plugin info:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.mortbay.jetty<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>jetty-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>8.1.8.v20121106<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div>
<h3>Configuration - hot-deploy</h3>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.mortbay.jetty<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jetty-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>8.1.8.v20121106<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;scanIntervalSeconds&gt;</span>1<span class="nt">&lt;/scanIntervalSeconds&gt;</span>
    <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div>
<p>If running <code>mvn jetty:run-exploded</code> then hot deploy is definied by <code>scanIntervalSeconds</code> interval</p>

<h3>Running</h3>

<p>then execute maven command:</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">mvn jetty:run
mvn jetty:run-exploded
mvn jetty:run-war
</code></pre></div>
<h1>JNDI</h1>

<h2>Variable</h2>

<h3>jetty.xml</h3>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;New</span> <span class="na">class=</span><span class="s">&quot;org.eclipse.jetty.plus.jndi.EnvEntry&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Arg&gt;&lt;/Arg&gt;</span>
  <span class="nt">&lt;Arg&gt;</span>mySpecialValue<span class="nt">&lt;/Arg&gt;</span>
  <span class="nt">&lt;Arg</span> <span class="na">type=</span><span class="s">&quot;java.lang.Integer&quot;</span><span class="nt">&gt;</span>666<span class="nt">&lt;/Arg&gt;</span>
  <span class="nt">&lt;Arg</span> <span class="na">type=</span><span class="s">&quot;boolean&quot;</span><span class="nt">&gt;</span>true<span class="nt">&lt;/Arg&gt;</span>
<span class="nt">&lt;/New&gt;</span>
</code></pre></div>
<h3>java code</h3>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="n">InitialContext</span> <span class="n">ic</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialContext</span><span class="o">();</span>
<span class="n">Integer</span> <span class="n">mySpecialValue</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span><span class="n">ic</span><span class="o">.</span><span class="na">lookup</span><span class="o">(</span><span class="s">&quot;java:comp/env/mySpecialValue&quot;</span><span class="o">);</span>
</code></pre></div>
<h3>web.xml</h3>

<p>Default value might be initialized as follows:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;env-entry&gt;</span>
        <span class="nt">&lt;env-entry-name&gt;</span>myEnvValue<span class="nt">&lt;/env-entry-name&gt;</span>
        <span class="nt">&lt;env-entry-type&gt;</span>java.lang.Integer<span class="nt">&lt;/env-entry-type&gt;</span>
        <span class="nt">&lt;env-entry-value&gt;</span>555<span class="nt">&lt;/env-entry-value&gt;</span>
    <span class="nt">&lt;/env-entry&gt;</span>
</code></pre></div>
<h2>Data source</h2>

<h3>driver</h3>

<p>Download driver and put it in folder <code>${JETTY}/lib/ext</code>. In our case it is DerbyClient driver.</p>

<h3>jetty.xml</h3>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;New</span> <span class="na">class=</span><span class="s">&quot;org.eclipse.jetty.plus.jndi.Resource&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Arg&gt;&lt;/Arg&gt;</span>
  <span class="nt">&lt;Arg&gt;</span>jdbc/myds<span class="nt">&lt;/Arg&gt;</span>
  <span class="nt">&lt;Arg&gt;</span>
    <span class="nt">&lt;New</span> <span class="na">class=</span><span class="s">&quot;org.apache.derby.jdbc.ClientDataSource&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;ServerName&quot;</span><span class="nt">&gt;</span>localhost<span class="nt">&lt;/Set&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;DatabaseName&quot;</span><span class="nt">&gt;</span>sun-appserv-samples<span class="nt">&lt;/Set&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;PortNumber&quot;</span><span class="nt">&gt;</span>1527<span class="nt">&lt;/Set&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;User&quot;</span><span class="nt">&gt;</span>APP<span class="nt">&lt;/Set&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;Password&quot;</span><span class="nt">&gt;</span>APP<span class="nt">&lt;/Set&gt;</span>
      <span class="nt">&lt;Set</span> <span class="na">name=</span><span class="s">&quot;createDatabase&quot;</span><span class="nt">&gt;</span>create<span class="nt">&lt;/Set&gt;</span>
    <span class="nt">&lt;/New&gt;</span>
  <span class="nt">&lt;/Arg&gt;</span>
<span class="nt">&lt;/New&gt;</span>
</code></pre></div>
<h3>web.xml</h3>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;resource-ref&gt;</span>
        <span class="nt">&lt;res-ref-name&gt;</span>jdbc/myds<span class="nt">&lt;/res-ref-name&gt;</span>
        <span class="nt">&lt;res-type&gt;</span>javax.sql.DataSource<span class="nt">&lt;/res-type&gt;</span>
        <span class="nt">&lt;res-auth&gt;</span>Container<span class="nt">&lt;/res-auth&gt;</span>
    <span class="nt">&lt;/resource-ref&gt;</span>
</code></pre></div>
<h3>java code</h3>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="n">InitialContext</span> <span class="n">ic</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialContext</span><span class="o">();</span>
<span class="n">DataSource</span> <span class="n">myds</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span><span class="n">ic</span><span class="o">.</span><span class="na">lookup</span><span class="o">(</span><span class="s">&quot;java:comp/env/jdbc/myds&quot;</span><span class="o">);</span>
</code></pre></div>
<h3>JPA configuration<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;persistence</span> <span class="na">version=</span><span class="s">&quot;2.0&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://java.sun.com/xml/ns/persistence&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;persistence-unit</span> <span class="na">name=</span><span class="s">&quot;default&quot;</span> <span class="na">transaction-type=</span><span class="s">&quot;RESOURCE_LOCAL&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;non-jta-data-source&gt;</span>jdbc/myds<span class="nt">&lt;/non-jta-data-source&gt;</span>
        <span class="nt">&lt;exclude-unlisted-classes&gt;</span>false<span class="nt">&lt;/exclude-unlisted-classes&gt;</span>
        <span class="nt">&lt;properties/&gt;</span>
    <span class="nt">&lt;/persistence-unit&gt;</span>
<span class="nt">&lt;/persistence&gt;</span>
</code></pre></div>
	</div>


	<script type="text/javascript">
	$(function(){
		$("#TOC").stoc({
				search: "#article-body",
				stocTitle: "<h1>Table of content</h1>"
			});
	});
	</script>

</article>

﻿<footer class="footer">
	<p>© Piotr Kosmowski. All right reserved. </p>
</footer>
		</div>
	</section>
  </body>
</html>